<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="partner_view_tree" model="ir.ui.view">
        <field name="name">library.partner.tree</field>
        <field name="model">res.partner</field>
        <field eval="8" name="priority"/>
        <field name="arch" type="xml">
            <tree string="Contacts" name="contacts">
                <field name="display_name" string="Name"/>
                <field name="function" invisible="1"/>
                <field name="phone"/>
                <field name="email"/>
                <field name="user_id" invisible="1"/>
                <field name="is_company" invisible="1"/>
                <field name="country_id" invisible="1"/>
                <field name="parent_id" invisible="1"/>
                <field name="active" invisible="1"/>
		<field name="amount_owed"/>
                <field name="is_author"/> 
                <field name="is_publisher"/>
            </tree>
        </field>
    </record>

    <record id="publisher_view_tree" model="ir.ui.view">
        <field name="name">library.publisher.tree</field>
        <field name="model">res.partner</field>
        <field eval="4" name="priority"/>
        <field name="inherit_id" ref="library.partner_view_tree"/>
        <field name="mode">primary</field>
        <field name="arch" type="xml">
          	<field name="amount_owed" position="replace"/>
                <field name="is_author" position="replace"/> 
                <field name="is_publisher" position="replace"/>
            
        </field>
    </record>


    <record id="partner_view_form" model="ir.ui.view">
        <field name="name">library.partner.form</field>
        <field name="model">res.partner</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title oe_left">
                        <h1>
                            <field name="name" placeholder="Name"/>
                        </h1>
                    </div>
		    <group>
			<field name="partner_type" invisible="1"/> 
                        <field name="amount_owed" attrs="{'invisible':[('partner_type','=','publisher')]}"/>
                        <field name="email"/>
                        <label for="street" string="Address"/>
                        <div class="o_address_format">
                            <field name="street" placeholder="Street..." class="o_address_street"/>
                            <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                            <field name="city" placeholder="City" class="o_address_city"/>
                            <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                            <field name="country_id" placeholder="Country" class="o_address_country"/>
                        </div>
                    </group>
		    <group>
			            <field name="is_author" attrs="{'invisible':[('is_publisher', '=', True)]}"/> 
                        <field name="is_publisher"/>
                        <field name="customer" attrs="{'invisible':[('is_publisher', '=', True)]}"/>     
                    </group>
		    <field name="qty_lost_book" invisible="1"/>
                    <notebook>
	                
	              	<page string="Books" name="Books"  attrs="{'invisible':[('is_author', '=', False)]}" >
		            <field name="book_ids" readonly="True"/>
		        </page>
		        <!--page string="Rentals" name="Rentals"  attrs="{'invisible':[('customer', '=', False)]}" >
	                     <field name="rental_ids" readonly="True"/>
	                </page-->
	                <page string="Books Published" name="Published"  attrs="{'invisible':[('is_publisher', '=', False)]}" >
	                     <field name="books_published" readonly="True"/>
	                </page>


                       <page string="Current rentals" name="current_rentals" attrs="{'invisible':[('customer','=',False)]}">
                            <field name="current_rental_ids" readonly="1">
                                <tree>
                                    <field name="book_id"/>
                                    <field name="book_author_names"/>
                                    <field name="rental_date"/>
                                    <field name="return_date"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Old rentals" name="old_rentals" attrs="{'invisible':[('customer','=',False)]}">
                            <field name="old_rental_ids" readonly="1">
                                <tree>
                                    <field name="book_id"/>
				    <field name="book_author_names"/>
                                    <field name="rental_date"/>
                                    <field name="return_date"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Lost rentals" name="lost_rentals"
                              attrs="{'invisible': [('qty_lost_book','=',0)]}">
                            <field name="lost_rental_ids" readonly="1">
                                <tree>
                                    <field name="book_id"/>
				    <field name="book_author_names"/>
                                    <field name="rental_date"/>
                                    <field name="return_date"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!--record id="partner_view_form" model="ir.ui.view">
        <field name="name">library.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <group name="purchase" position="after">
                <group string="Library Mgmt" name="library">
                    <field name="is_author"/>
                    <field name="is_publisher"/>
                </group>
            </group>
            <page name="sales_purchases" position="after">
		<page string="Books" name="Books"  attrs="{'invisible':[('is_author', '=', False)]}" >
	            <field name="book_ids" readonly="True"/>
	        </page>
	        <page string="Rented Books" name="Rentals"  attrs="{'invisible':['|',('is_author', '=', True),('is_publisher','=',True)]}" >
                     <field name="rental_ids" readonly="True"/>
                </page>
                <page string="Books Published" name="Published"  attrs="{'invisible':[('is_publisher', '=', False)]}" >
                     <field name="books_published" readonly="True"/>
                </page>
	    </page>
        </field>
    </record-->

    <record id="partner_view_search" model="ir.ui.view">
        <field name="name">library.partner.search</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_res_partner_filter"/>
        <field name="arch" type="xml">
            <search>
                <field name="amount_owed"/>
            </search>
            <!--filter name="inactive" position="after">
                <filter string="Authors" name="is_author" domain="[('is_author', '=', True)]"/>
    		<filter string="Publishers" name="is_publisher" domain="[('is_publisher', '=', True)]"/>
            </filter-->
        </field>
    </record>

    <record id="partner_action" model="ir.actions.act_window">
        <field name="name">Contacts</field>
        <field name="res_model">res.partner</field>
        <field name="domain">[('customer','=',True)]</field>
        <field name="context"> {
   		'default_customer':True,
                'default_partner_type':'customer',
	    }
        </field>
        <field name="view_mode">tree,form</field>
    </record>


    <record id="publisher_action" model="ir.actions.act_window">
        <field name="name">Publisher</field>
        <field name="res_model">res.partner</field>
        <field name="domain">[('is_publisher','=',True)]</field>
        <field name="context"> {
   		'default_is_publisher':True,
                'default_customer':False,
                'default_partner_type':'publisher',
	    }
        </field>

        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                  Add a Publisher
                </p><p>
                  Publishers are mapped to their books.
                </p>
        </field>

    </record>



    <record id="partner_action_view_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="sequence" eval="10"/>
        <field name="view_id" ref="library.partner_view_tree"/>
        <field name="act_window_id" ref="library.partner_action"/>
    </record>

    <record id="publisher_action_view_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="sequence" eval="10"/>
        <field name="view_id" ref="library.publisher_view_tree"/>
        <field name="act_window_id" ref="library.publisher_action"/>

    </record>

    <record id="publisher_action_view_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="sequence" eval="20"/>
        <field name="view_id" ref="library.partner_view_form"/>
        <field name="act_window_id" ref="library.publisher_action"/>
    </record>

    <record id="partner_action_view_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="sequence" eval="20"/>
        <field name="view_id" ref="library.partner_view_form"/>
        <field name="act_window_id" ref="library.partner_action"/>
    </record>



</odoo>

